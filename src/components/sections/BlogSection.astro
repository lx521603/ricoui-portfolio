---
import BlogCard from "@/components/blog/BlogCard.astro";
import { getCollection } from "astro:content";

const {
  title = "最新文章",
  description,
  limit = 6,
  layout = "grid"
} = Astro.props;

const posts = (await getCollection("blog"))
  .filter((p) => !p.data.draft)
  .sort((a, b) => new Date(b.data.publishDate) - new Date(a.data.publishDate))
  .slice(0, limit);
---

<section class="w-full py-12">
  <div class="mx-auto max-w-7xl px-4">
    <div class="mb-10">
      <h2 class="text-3xl font-bold">{title}</h2>
      {description && <p class="text-neutral-600 dark:text-neutral-400 mt-2">{description}</p>}
    </div>

    {posts.length === 0 ? (
      <p class="text-neutral-500 dark:text-neutral-400">暂无文章</p>
    ) : (
      <div
        class:list={[
          "grid gap-8",
          layout === "grid" && "md:grid-cols-2 lg:grid-cols-3",
          layout === "list" && "flex flex-col gap-10"
        ]}
      >
        {posts.map((post) => (
          <BlogCard
            content={{
              ...post.data,
              slug: post.slug,
              link: `/blog/${post.slug}`,
            }}
          />
        ))}
      </div>
    )}
  </div>
</section>